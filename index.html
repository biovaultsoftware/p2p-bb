<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <meta name="theme-color" content="#0b1220"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <link rel="manifest" href="./manifest.webmanifest"/>
  <link rel="icon" href="./icons/icon-192.png"/>
  <link rel="apple-touch-icon" href="./icons/icon-192.png"/>
  <title>BC Lightning Messaging</title>
  <style>
    :root{
      --bg:#070b14; --panel:#0c1325; --panel2:#0b1220; --border:rgba(255,255,255,.08);
      --text:#e8eefc; --muted:rgba(232,238,252,.72); --ok:#35d07f; --warn:#f7c948; --err:#ff5c5c;
      --btn:#111a33; --btnh:#16224a;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }
    body{ margin:0; background:radial-gradient(1200px 600px at 15% 0%, #101a35 0%, var(--bg) 60%); color:var(--text); }
    .wrap{ max-width:1200px; margin:18px auto; padding:0 14px; }
    .hdr{ display:flex; justify-content:space-between; align-items:flex-start; gap:10px; }
    h1{ margin:0; font-size:18px; letter-spacing:.2px; }
    .sub{ color:var(--muted); font-size:12px; margin-top:4px; }
    .pill{ font-size:12px; padding:6px 10px; border-radius:999px; border:1px solid var(--border); background:rgba(0,0,0,.18); }
    .grid{ display:grid; grid-template-columns: 340px 1fr; gap:12px; margin-top:12px; }
    .card{ background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02)); border:1px solid var(--border); border-radius:14px; overflow:hidden; }
    .card h2{ margin:0; padding:12px 14px; font-size:13px; color:var(--muted); border-bottom:1px solid var(--border); }
    .pane{ padding:12px 14px; }
    input, button{ font:inherit; }
    .row{ display:flex; gap:8px; }
    .row input{ flex:1; background:rgba(0,0,0,.25); color:var(--text); border:1px solid var(--border); border-radius:10px; padding:10px 10px; outline:none; }
    .btn{ background:var(--btn); color:var(--text); border:1px solid var(--border); border-radius:10px; padding:10px 12px; cursor:pointer; }
    .btn:hover{ background:var(--btnh); }
    .btn.small{ padding:8px 10px; font-size:12px; }
    .list{ display:flex; flex-direction:column; gap:6px; margin-top:10px; }
    .item{ display:flex; justify-content:space-between; align-items:center; gap:10px; padding:10px 10px; border-radius:12px; border:1px solid var(--border); background:rgba(0,0,0,.18); cursor:pointer; }
    .item .a{ font-size:13px; }
    .item .b{ font-size:11px; color:var(--muted); }
    .chat{ height:60vh; overflow:auto; padding:14px; }
    .bubble{ max-width:78%; padding:10px 12px; border-radius:14px; margin:6px 0; border:1px solid var(--border); background:rgba(0,0,0,.18); }
    .me{ margin-left:auto; background:rgba(53,208,127,.08); }
    .meta{ font-size:11px; color:var(--muted); margin-top:3px; }
    .composer{ display:flex; gap:8px; padding:12px 14px; border-top:1px solid var(--border); }
    .composer input{ flex:1; }
    .statusline{ display:flex; gap:10px; flex-wrap:wrap; color:var(--muted); font-size:12px; margin-top:10px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hdr">
      <div>
        <h1>BC Lightning Messaging</h1>
        <div class="sub">Communication is a shared state between two humans — receiver pulls, sender holds intents.</div>
      </div>
      <div class="pill" id="mePill">Me: …</div>
    </div>

    <div class="statusline">
      <div>Chain head: <span id="head">—</span></div>
      <div>Len: <span id="len">—</span></div>
      <div>Signal: <span id="signalStatus">—</span></div>
      <div>P2P: <span id="p2pStatus">—</span></div>
    </div>

    <div class="grid">
      <div class="card">
        <h2>Contacts</h2>
        <div class="pane">
          <div class="row">
            <input id="peerHid" placeholder="Paste contact HID-..." />
            <button class="btn" id="btnAdd">Add</button>
          </div>
          <div class="list" id="contacts"></div>
          <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap;">
            <button class="btn small" id="btnExport">Export</button>
            <button class="btn small" id="btnImport">Import</button>
            <button class="btn small" id="btnReset">Reset</button>
          </div>
        </div>
      </div>

      <div class="card">
        <h2 id="chatTitle">Chat</h2>
        <div class="chat" id="chat"></div>
        <div class="composer">
          <input id="msg" placeholder="Write…" />
          <button class="btn" id="btnSync">Sync</button>
          <button class="btn" id="send">Send</button>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="./app.js"></script>
</body>
</html>
